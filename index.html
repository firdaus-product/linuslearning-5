<!DOCTYPE html>
<html lang="ms-MY">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Klik & Belajar: Nombor 0-10</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body{box-sizing:border-box}
    .drag-item{cursor:grab}
    .drag-item:active{cursor:grabbing}
    .drop-zone{min-height:80px;border:2px dashed #cbd5e1;transition:all .3s}
    .drop-zone.drag-over{border-color:#3b82f6;background:#eff6ff}
    .number-card{transition:all .3s}
    .number-card:hover{transform:scale(1.05)}
    .selected{ring:4px;--tw-ring-color:#3b82f6;transform:scale(1.1)}
    .coloring-item{cursor:pointer;stroke:#374151;stroke-width:3;fill:white;transition:all .3s}
    .coloring-item:hover{stroke-width:4}
  </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-purple-50 min-h-screen">
  <div class="container mx-auto p-4 max-w-6xl">
    <!-- Header -->
    <header class="text-center mb-6">
      <h1 class="text-4xl font-bold text-purple-800 mb-2">üî¢ Klik & Belajar: Nombor 0-10</h1>
      <p class="text-lg text-gray-600">Pembelajaran interaktif untuk murid 5-7 tahun</p>
    </header>

    <!-- Info Bar -->
    <div class="bg-yellow-100 border-l-4 border-yellow-500 p-4 mb-6 rounded-lg shadow-md">
      <div class="flex items-center justify-between">
        <div class="flex items-center">
          <span class="text-2xl mr-3">‚ÑπÔ∏è</span>
          <p id="info-text" class="text-xl font-medium text-gray-800">Klik mana-mana elemen untuk belajar.</p>
        </div>
        <button id="speak-btn" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg text-xl font-bold min-w-[44px] min-h-[44px]">üîä</button>
      </div>
    </div>

    <!-- Activity Card -->
    <div class="bg-white rounded-xl shadow-lg p-6 mb-6 min-h-[400px]">
      <div id="activity-content" class="text-center">
        <div class="text-6xl mb-4">üéØ</div>
        <h2 class="text-2xl font-bold text-gray-800 mb-4">Pilih aktiviti untuk mula belajar!</h2>
        <p class="text-lg text-gray-600">Klik butang aktiviti di bawah untuk bermula.</p>
      </div>
    </div>

    <!-- Activity Controls -->
    <div class="bg-white rounded-xl shadow-lg p-6">
      <div class="grid grid-cols-2 md:grid-cols-5 gap-4 mb-4">
        <button onclick="loadActivity(1)" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-3 rounded-lg font-bold text-lg min-h-[44px]">1Ô∏è‚É£ Pilih Nombor</button>
        <button onclick="loadActivity(2)" class="bg-green-500 hover:bg-green-600 text-white px-4 py-3 rounded-lg font-bold text-lg min-h-[44px]">2Ô∏è‚É£ Susun Tertib</button>
        <button onclick="loadActivity(3)" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-3 rounded-lg font-bold text-lg min-h-[44px]">3Ô∏è‚É£ Padankan</button>
        <button onclick="loadActivity(4)" class="bg-orange-500 hover:bg-orange-600 text-white px-4 py-3 rounded-lg font-bold text-lg min-h-[44px]">4Ô∏è‚É£ Warnakan</button>
        <button onclick="loadActivity(5)" class="bg-pink-500 hover:bg-pink-600 text-white px-4 py-3 rounded-lg font-bold text-lg min-h-[44px]">5Ô∏è‚É£ Bilang Objek</button>
      </div>
      <div class="flex gap-4">
        <button onclick="clearActivity()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg font-bold text-lg min-h-[44px]">üßπ Bersih</button>
        <button onclick="nextActivity()" class="bg-indigo-500 hover:bg-indigo-600 text-white px-6 py-3 rounded-lg font-bold text-lg min-h-[44px]">‚û°Ô∏è Seterusnya</button>
      </div>
    </div>
  </div>

  <script>
    /* ========= TTS Stabil: pilih suara Melayu dengan fallback ========= */
    let ttsUnlocked = false;
    let msVoice = null;

    function pickMalayVoice(){
      if(!('speechSynthesis' in window)) return;
      const voices = speechSynthesis.getVoices();
      // 1) ms-MY
      msVoice = voices.find(v => v.lang?.toLowerCase().startsWith('ms'));
      // 2) nama mengandungi Malay/Melayu (Windows)
      if(!msVoice) msVoice = voices.find(v => /malay|melayu/i.test(v.name));
      // 3) Indonesia
      if(!msVoice) msVoice = voices.find(v => v.lang?.toLowerCase().startsWith('id'));
    }

    function initTTS(){
      if(!('speechSynthesis' in window)) return;
      pickMalayVoice();
      speechSynthesis.onvoiceschanged = () => pickMalayVoice();
      // pastikan tak "sleep"
      setInterval(() => { try { if(speechSynthesis.paused) speechSynthesis.resume(); } catch(_){} }, 1200);
    }

    function unlockTTS(){
      if(ttsUnlocked) return;
      try{ speechSynthesis.cancel(); }catch{}
      speechSynthesis.speak(new SpeechSynthesisUtterance('')); // prime
      ttsUnlocked = true;
      pickMalayVoice();
    }

    function speak(text){
      if(!('speechSynthesis' in window) || !text) return;
      unlockTTS();
      try{ speechSynthesis.cancel(); }catch{}
      const u = new SpeechSynthesisUtterance(text);
      u.lang = 'ms-MY';
      u.rate = 0.85;
      u.pitch = 1.05;
      if(msVoice) u.voice = msVoice;
      setTimeout(() => speechSynthesis.speak(u), 60);
    }

    function setInfo(text){ document.getElementById('info-text').textContent = text; }

    initTTS();
    document.addEventListener('click', unlockTTS, { once:true });
    document.getElementById('speak-btn').addEventListener('click', () => speak(document.getElementById('info-text').textContent));

    /* ===================== Aktiviti ===================== */
    let currentActivity = 0;

    // Aktiviti 1: Klik Nombor
    function activity1(){
      const numbers = [
        { num:0, word:'sifar', emoji:'‚≠ï' }, { num:1, word:'satu', emoji:'1Ô∏è‚É£' },
        { num:2, word:'dua', emoji:'2Ô∏è‚É£' },   { num:3, word:'tiga', emoji:'3Ô∏è‚É£' },
        { num:4, word:'empat', emoji:'4Ô∏è‚É£' }, { num:5, word:'lima', emoji:'5Ô∏è‚É£' },
        { num:6, word:'enam', emoji:'6Ô∏è‚É£' },  { num:7, word:'tujuh', emoji:'7Ô∏è‚É£' },
        { num:8, word:'lapan', emoji:'8Ô∏è‚É£' }, { num:9, word:'sembilan', emoji:'9Ô∏è‚É£' },
        { num:10, word:'sepuluh', emoji:'üîü' }
      ];
      let html = `
        <h2 class="text-3xl font-bold text-blue-800 mb-6">üéØ Pilih dan Belajar Nombor</h2>
        <div class="grid grid-cols-3 md:grid-cols-6 gap-4">`;
      numbers.forEach(it=>{
        html += `
          <div class="number-card bg-blue-100 hover:bg-blue-200 p-4 rounded-xl text-center cursor-pointer border-2 border-blue-300"
               onclick="selectNumber(event, ${it.num}, '${it.word}', '${it.emoji}')">
            <div class="text-4xl mb-2">${it.emoji}</div>
            <div class="text-2xl font-bold text-blue-800">${it.num}</div>
            <div class="text-lg text-blue-600">${it.word}</div>
          </div>`;
      });
      html += `</div>`;
      return html;
    }
    function selectNumber(ev, num, word){
      setInfo(`Ini nombor ${num}. Sebutan: ${word}.`);
      speak(`Ini nombor ${word}.`);   // ‚Üê elak pengulangan angka+perkataan
      const card = ev.currentTarget;
      card.classList.add('selected');
      setTimeout(()=> card.classList.remove('selected'), 900);
    }

    // Aktiviti 2: Susun Tertib (drag & drop)
    function activity2(){
      const numbers = [3,7,1,9,5,0,10,2];
      let html = `
        <h2 class="text-3xl font-bold text-green-800 mb-2">üìä Susun Nombor Mengikut Tertib</h2>
        <p class="text-lg mb-4 text-gray-700">Seret nombor ke kotak (0 ‚Üí 10). Info Bar akan sebut nombor yang anda letak.</p>
        <div class="mb-6">
          <h3 class="text-xl font-bold mb-3">Nombor untuk disusun:</h3>
          <div class="flex flex-wrap gap-3 mb-6">`;
      numbers.forEach((n,i)=>{
        html += `<div class="drag-item bg-yellow-200 px-4 py-3 rounded-lg text-xl font-bold border-2 border-yellow-400"
                     draggable="true" data-number="${n}" id="drag-${i}">${n}</div>`;
      });
      html += `
          </div>
        </div>
        <div class="mb-4">
          <h3 class="text-xl font-bold mb-3">Susun di sini (0 hingga 10):</h3>
          <div class="drop-zone bg-gray-100 p-4 rounded-lg min-h-[100px] flex flex-wrap gap-2"
               ondrop="dropNumber(event)" ondragover="allowDrop(event)">
            <p class="text-gray-500 w-full text-center">Seret nombor ke sini</p>
          </div>
        </div>`;
      return html;
    }
    function allowDrop(e){ e.preventDefault(); const z=e.target.closest('.drop-zone'); if(z) z.classList.add('drag-over'); }
    function dropNumber(e){
      e.preventDefault();
      const z = e.target.closest('.drop-zone'); if(z) z.classList.remove('drag-over');
      const id = e.dataTransfer.getData('text');
      const el = document.getElementById(id);
      if(el){ z.appendChild(el); const n = el.dataset.number; setInfo(`Nombor ${n} diletakkan.`); speak(`Nombor ${n}`); }
    }

    // Aktiviti 3: Padankan nombor ‚Üî perkataan
    function activity3(){
      const pairs = [
        {num:1, word:'satu'}, {num:3, word:'tiga'}, {num:5, word:'lima'},
        {num:7, word:'tujuh'}, {num:9, word:'sembilan'}, {num:10, word:'sepuluh'}
      ];
      const shuffled = [...pairs].sort(()=>Math.random()-0.5);
      let html = `
        <h2 class="text-3xl font-bold text-purple-800 mb-6">üîó Padankan Nombor dengan Perkataan</h2>
        <p class="text-lg mb-4 text-gray-700">Klik nombor, kemudian klik perkataan yang sepadan. Sistem akan menyebut pilihan anda.</p>
        <div class="grid grid-cols-2 gap-8">
          <div>
            <h3 class="text-xl font-bold mb-3 text-center">Nombor</h3>
            <div class="space-y-3">`;
      pairs.forEach(p=>{
        html += `<div class="match-item bg-blue-200 p-4 rounded-lg text-center cursor-pointer text-2xl font-bold border-2 border-blue-400"
                      data-type="number" data-value="${p.num}" onclick="selectMatch(this)">${p.num}</div>`;
      });
      html += `</div></div><div>
            <h3 class="text-xl font-bold mb-3 text-center">Perkataan</h3>
            <div class="space-y-3">`;
      shuffled.forEach(p=>{
        html += `<div class="match-item bg-green-200 p-4 rounded-lg text-center cursor-pointer text-xl font-bold border-2 border-green-400"
                      data-type="word" data-value="${p.num}" onclick="selectMatch(this)">${p.word}</div>`;
      });
      html += `</div></div></div>`;
      return html;
    }
    let selectedMatch = null;
    function selectMatch(el){
      if(!selectedMatch){
        selectedMatch = el;
        el.classList.add('selected');
        speak(el.textContent.trim());
        setInfo(`Dipilih: ${el.textContent.trim()}. Pilih pasangannya.`);
      }else{
        const same = selectedMatch.dataset.value === el.dataset.value;
        const berlainanJenis = selectedMatch.dataset.type !== el.dataset.type;
        if(same && berlainanJenis){
          selectedMatch.style.backgroundColor = '#10b981';
          el.style.backgroundColor = '#10b981';
          selectedMatch.style.color = el.style.color = 'white';
          speak(`Padanan: ${selectedMatch.dataset.value} dengan ${el.textContent.trim()}.`);
          setInfo(`Padanan: ${selectedMatch.dataset.value} = ${el.textContent.trim()}.`);
        }else{
          speak('Belum sepadan. Cuba pilih pasangan lain.');
          setInfo('Belum sepadan. Cuba pilih pasangan lain.');
        }
        selectedMatch.classList.remove('selected');
        selectedMatch = null;
      }
    }

    // Aktiviti 4: Warnakan nombor
    function activity4(){
      let html = `
        <h2 class="text-3xl font-bold text-orange-800 mb-6">üé® Warnakan Nombor</h2>
        <p class="text-lg mb-4 text-gray-700">Klik warna, kemudian klik nombor untuk mewarnakan sambil mendengar sebutan.</p>
        <div class="mb-4">
          <h3 class="text-lg font-bold mb-2">Pilih warna:</h3>
          <div class="flex gap-2 mb-4">
            <div class="w-8 h-8 bg-red-500 rounded cursor-pointer border-2 border-gray-400" onclick="selectColor('#ef4444')"></div>
            <div class="w-8 h-8 bg-blue-500 rounded cursor-pointer border-2 border-gray-400" onclick="selectColor('#3b82f6')"></div>
            <div class="w-8 h-8 bg-green-500 rounded cursor-pointer border-2 border-gray-400" onclick="selectColor('#10b981')"></div>
            <div class="w-8 h-8 bg-yellow-500 rounded cursor-pointer border-2 border-gray-400" onclick="selectColor('#eab308')"></div>
            <div class="w-8 h-8 bg-purple-500 rounded cursor-pointer border-2 border-gray-400" onclick="selectColor('#8b5cf6')"></div>
            <div class="w-8 h-8 bg-pink-500 rounded cursor-pointer border-2 border-gray-400" onclick="selectColor('#ec4899')"></div>
          </div>
        </div>
        <svg width="100%" height="300" viewBox="0 0 800 300" class="border rounded-lg bg-white">`;
      const nums = [
        {num:0, word:'sifar', x:50, y:150},{num:1, word:'satu', x:130, y:150},{num:2, word:'dua', x:210, y:150},
        {num:3, word:'tiga', x:290, y:150},{num:4, word:'empat', x:370, y:150},{num:5, word:'lima', x:450, y:150},
        {num:6, word:'enam', x:530, y:150},{num:7, word:'tujuh', x:610, y:150},{num:8, word:'lapan', x:690, y:150},
        {num:9, word:'sembilan', x:290, y:80},{num:10, word:'sepuluh', x:450, y:80}
      ];
      nums.forEach(it=>{
        html += `<text x="${it.x}" y="${it.y}" class="coloring-item text-4xl font-bold"
                       onclick="colorNumber(this, ${it.num}, '${it.word}')" text-anchor="middle" dominant-baseline="middle">${it.num}</text>`;
      });
      html += `</svg>`;
      return html;
    }
    let selectedColor = '#3b82f6';
    function selectColor(c){ selectedColor=c; setInfo('Warna dipilih. Klik nombor untuk mewarnakan.'); }
    function colorNumber(el, num, word){
      el.style.fill = selectedColor;
      setInfo(`Nombor ${num} diwarnakan. Sebutan: ${word}.`);
      speak(`Nombor ${word}.`);   // ‚Üê elak pengulangan angka+perkataan
    }

    // Aktiviti 5: Bilang objek
    function activity5(){
      const items = [
        {count:3, emoji:'üçé', name:'epal'}, {count:7, emoji:'‚≠ê', name:'bintang'},
        {count:5, emoji:'üê±', name:'kucing'}, {count:9, emoji:'üå∏', name:'bunga'},
        {count:2, emoji:'üöó', name:'kereta'}, {count:6, emoji:'üéà', name:'belon'}
      ];
      let html = `
        <h2 class="text-3xl font-bold text-pink-800 mb-6">üî¢ Bilang Objek</h2>
        <p class="text-lg mb-4 text-gray-700">Klik pada kumpulan objek untuk mendengar bilangannya.</p>
        <div class="grid grid-cols-2 md:grid-cols-3 gap-6">`;
      items.forEach(it=>{
        html += `<button class="bg-pink-100 p-4 rounded-xl text-center border-2 border-pink-300 hover:bg-pink-200"
                         onclick="countObjects(${it.count}, '${it.name}')">
                   <div class="text-3xl mb-2">${it.emoji.repeat(it.count)}</div>
                   <p class="text-lg font-bold text-pink-800">Bilang ${it.name}</p>
                 </button>`;
      });
      html += `</div>`;
      return html;
    }
    function countObjects(count, name){
      const words = ['sifar','satu','dua','tiga','empat','lima','enam','tujuh','lapan','sembilan','sepuluh'];
      setInfo(`Ada ${count} ${name}. Sebutan: ${words[count]}.`);
      speak(`Ada ${words[count]} ${name}.`);
    }

    /* =============== Loader / Controls =============== */
    function loadActivity(num){
      currentActivity = num;
      let content = '';
      switch(num){
        case 1: content = activity1(); setInfo('Klik nombor untuk belajar sebutan dan bentuknya.'); break;
        case 2: content = activity2(); setInfo('Seret nombor untuk menyusun dari kecil ke besar.'); break;
        case 3: content = activity3(); setInfo('Padankan nombor dengan perkataan yang sepadan.'); break;
        case 4: content = activity4(); setInfo('Pilih warna, kemudian klik nombor untuk mewarnakan.'); break;
        case 5: content = activity5(); setInfo('Klik kumpulan objek untuk belajar membilang.'); break;
      }
      document.getElementById('activity-content').innerHTML = content;

      // Wire drag events untuk aktiviti 2
      if(num===2){
        setTimeout(()=>{
          document.querySelectorAll('.drag-item').forEach(it=>{
            it.addEventListener('dragstart', e => e.dataTransfer.setData('text', e.target.id));
          });
          document.querySelectorAll('.drop-zone').forEach(z=>{
            z.addEventListener('dragleave', e => e.target.classList.remove('drag-over'));
          });
        }, 0);
      }
    }

    function clearActivity(){
      document.getElementById('activity-content').innerHTML = `
        <div class="text-center">
          <div class="text-6xl mb-4">üßπ</div>
          <h2 class="text-2xl font-bold text-gray-800 mb-4">Aktiviti telah dibersihkan!</h2>
          <p class="text-lg text-gray-600">Pilih aktiviti baru untuk terus belajar.</p>
        </div>`;
      setInfo('Aktiviti dibersihkan. Pilih aktiviti baru.');
      currentActivity = 0;
    }
    function nextActivity(){ const next = currentActivity >= 5 ? 1 : currentActivity + 1; loadActivity(next); }
  </script>

  <!-- Cloudflare script stub (abaikan jika tidak perlu pada hosting anda) -->
  <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'98f466e2c3806b5d',t:'MTc2MDU4NDYzMy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script>
</body>
</html>
